@(eventForm:models.forms.RawForm, cloneForm:models.forms.RawForm)
@import views.widgets.AdminWidget
@import views.widgets.FormsWidget
@import models.Event
@import scala.List
@main_with_menu("Администрирование " + Event.current.getTitle)(List(AdminWidget.get, FormsWidget.get)) { } {
    <h1>Администрирование мероприятия @Event.current.getTitle</h1>

    @if(flash.get("message") != null) {
        <p class='warning'>@flash.get("message")</p>
    }

    @models.Forms.getEventChangeForm.formatExtended(eventForm, controllers.routes.EventAdministration.admin(Event.currentId), true, "form.do_change")

    <h2>Список школ:</h2>
    <form enctype="multipart/form-data" method="POST" action="@routes.EventAdministration.uploadKenguruSchoolCodes(Event.currentId)">
        <input type="file" name="kenguru-codes">
        <input type="submit" value="Загрузить файл">
    </form>

    <p></p>
    <h2>Данные по событию:</h2>
    @for((table, ind) <- Event.current.getTables.zipWithIndex) {
        <p>@(ind + 1). @table.getTitle: <a href="@routes.EventAdministration.csvTable(Event.currentId, ind)">скачать</a></p>
    }

    <h2>Очистка результатов</h2>
    <p>После изменения настроек процесса подведения итогов может оказаться, что уже вычисленные результаты участников более неактуальны. В этом случае
        необходимо очистить вычисленные результаты.
    </p>
    <p><a href="#" class='submit actions-invalidate-event-results' title="Опустить вниз">Очистить результаты события</a></p>
    <p><a href="#" class='submit actions-invalidate-all-event-results' title="Опустить вниз">Очистить результаты события и всех соревнований</a></p>
    <form action="@routes.EventAdministration.doInvalidateEventResults(Event.currentId())" method="POST" class='submit actions-invalidate-event-results'></form>
    <form action="@routes.EventAdministration.doInvalidateContestsAndEventResults(Event.currentId())" method="POST" class='submit actions-invalidate-all-event-results'></form>

    <h2>Клонировать событие</h2>
    @models.Forms.getCloneEventForm.formatExtended(eventForm, controllers.routes.EventAdministration.doClone(Event.currentId), false, "form.do_add")

    <h2>Удаление события</h2>

    <form action="@routes.EventAdministration.doRemoveEvent(Event.currentId)" method="POST" class='actions-remove-event'></form>
    <a href="#" class='submit actions-remove-event' title='Удалить...'>Удалить событие</a>
}