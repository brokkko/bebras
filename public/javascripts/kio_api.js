var kio_api=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([,,function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=new l("Результат",t.problem.parameters()),i=new l("Рекорд",t.problem.parameters()),o=document.createElement("div"),r=document.createElement("div");o.appendChild(n.domNode),o.appendChild(i.domNode),n.domNode.className+=" kio-results-info-panel",i.domNode.className+=" kio-record-info-panel";var a=new u("Очистить",function(){t.problem.loadSolution(t.emptySolution)}),s=new u("Загрузить рекорд",function(){t.problem.loadSolution(t.best)});return r.appendChild(a.domNode),r.appendChild(s.domNode),r.className="kio-control-buttons-area",e.appendChild(o),e.appendChild(r),{results_info_panel:n,record_info_panel:i}}var r=n(6);n.n(r);t.a=o;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(){function e(t,n){i(this,e),this.title=t,this.params=n,this.domNode=document.createElement("div"),this.inject_inside(this.domNode)}return a(e,[{key:"setParams",value:function(e){var t=0,n=!0,i=!1,o=void 0;try{for(var r,a=this.params[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var l=r.value;if(l.title){var u=this.value_elements[t],s=e[l.name];u.innerText=this.paramViewFunction(l)(s),t++}}}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}}},{key:"paramViewFunction",value:function(e){return e.view?"function"==typeof e.view?e.view:function(t){return t+e.view}:function(e){return e}}},{key:"inject_inside",value:function(e){e.className="kio-info-panel",this.param_name_2_param={},this.param_name_2_value_element={};var t=document.createElement("table"),n=document.createElement("thead"),i=document.createElement("tbody");n.className="kio-info-panel-head",t.appendChild(n),t.appendChild(i);var o=document.createElement("tr"),r=document.createElement("td");r.colspan=2,n.appendChild(o),o.appendChild(r),r.innerText=this.title,this.value_elements=[];var a=!0,l=!1,u=void 0;try{for(var s,c=this.params[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var d=s.value;if(d.title){var m=document.createElement("tr"),p=document.createElement("td"),f=document.createElement("td");m.appendChild(p),m.appendChild(f),p.className="kio-info-panel-param-name",f.className="kio-info-panel-param-value",p.innerText=d.title,i.appendChild(m),this.value_elements.push(f)}}}catch(e){l=!0,u=e}finally{try{!a&&c.return&&c.return()}finally{if(l)throw u}}e.appendChild(t)}}]),e}(),u=function(){function e(t,n){i(this,e),this.domNode=document.createElement("button"),this.domNode.className="kio-control-button",this.title=t,$(this.domNode).click(n)}return a(e,[{key:"title",set:function(e){this._title=e,this.domNode.innerText=e},get:function(){return this._title}}]),e}()},,,,function(e,t){},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n,i){function o(e,n){var i=n.loading_queue;t.removeChild(c);var o=new u(s,t,i);o.init_view(t,s),o.saveEmptySolution(),o.loadSolution(o.best_from_server),o.loadSolution(o.autosavedSolution()),o.problem_is_initialized=!0}function r(){c.innerText="Ошибка при загрузке задачи, попробуйте обновить страницу"}function a(e){c.innerText="Загрузка "+e.progress+"%"}function l(){var e=document.createElement("div");return e.className="loading-info",e}var s=new e(n),c=l();if(t.appendChild(c),s.preloadManifest){var d=new createjs.LoadQueue(!0,i);d.on("complete",o,null,!1,{loading_queue:d}),d.on("error",r),d.on("progress",a);var m=s.preloadManifest();d.loadManifest(m)}else o(null,{loading_queue:null})}function r(e,t){if(t&&t.sol){var n=JSON.parse(t.sol),i=dces2contest.get_problem_index(e);s[i]=n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.initializeKioProblem=o;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(){function e(t,n,o){i(this,e),this.problem=t,this.domNode=n,this.pid=dces2contest.get_problem_index($(n)),this.best_from_server=s[dces2contest.get_problem_index($(n))],this.best=null,this.bestResult=null,this.autosave_localstorage_key="kio-problem-"+this.problem.id()+"-autosave",this.loading_queue=o,this.problem_is_initialized=!1}return l(e,[{key:"saveEmptySolution",value:function(){this.emptySolution=this.problem.solution()}},{key:"loadSolution",value:function(e){null!==e&&this.problem.loadSolution(e)}},{key:"bestSolution",value:function(){return this.best}},{key:"autosavedSolution",value:function(){return JSON.parse(localStorage.getItem(this.autosave_localstorage_key))}},{key:"autosaveSolution",value:function(){this.problem_is_initialized&&localStorage.setItem(this.autosave_localstorage_key,JSON.stringify(this.problem.solution()))}},{key:"newRecord",value:function(e,t){this.problem_is_initialized&&dces2contest.submit_answer(this.pid,{sol:JSON.stringify(e),res:JSON.stringify(t)})}},{key:"submitResult",value:function(e){this.results_info_panel.setParams(e),this.autosaveSolution();var t=this.compareResults(e,this.bestResult);t>0&&(this.bestResult=e,this.best=this.problem.solution(),this.newRecord(this.best,e),this.record_info_panel.setParams(e))}},{key:"compareResults",value:function(e,t){if(null==e&&null==t)return 0;if(null==e)return-1;if(null==t)return 1;var n=this.problem.parameters(),i=!0,o=!1,r=void 0;try{for(var a,l=n[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var u=a.value,s=e[u.name],c=t[u.name];u.normalize&&(s=u.normalize(s),c=u.normalize(c));var d="maximize"===u.ordering?s-c:c-s;if(Math.abs(d)>1e-9)return d>0?1:-1}}catch(e){o=!0,r=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw r}}return 0}},{key:"getResource",value:function(e){return this.loading_queue.getResult(e)}},{key:"init_view",value:function(e,t){var i=document.createElement("div"),o=document.createElement("div");e.appendChild(i),e.appendChild(o);var r=n.i(a.a)(o,this);this.results_info_panel=r.results_info_panel,this.record_info_panel=r.record_info_panel,t.initialize(i,this)}}]),e}();dces2contest.register_solution_loader("kio-online",r);var s=[]}]);