var kio_api=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([,,function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=new l("Результат",t.problem.parameters()),i=new l("Рекорд",t.problem.parameters());e.appendChild(n.domNode),e.appendChild(i.domNode),n.domNode.className+=" kio-base-results-info-panel",i.domNode.className+=" kio-base-record-info-panel";var o=new s("Очистить решение",function(){t.problem.loadSolution(t.emptySolution)}),a=new s("Загрузить рекорд",function(){t.problem.loadSolution(t.best)});n.domNode.appendChild(o.domNode),i.domNode.appendChild(a.domNode),e.className="kio-base-controls-container";var r=document.createElement("div");return r.className="kio-base-clear-both",e.appendChild(r),{results_info_panel:n,record_info_panel:i}}var a=n(6);n.n(a);t.a=o;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(){function e(t,n){i(this,e),this.title=t,this.params=n,this.domNode=document.createElement("div"),this.inject_inside(this.domNode)}return r(e,[{key:"setParams",value:function(e){var t=0,n=!0,i=!1,o=void 0;try{for(var a,r=this.params[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var l=a.value;if(l.title){var s=this.value_elements[t],u=e[l.name];s.innerText=this.paramViewFunction(l)(u),t++}}}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}}},{key:"paramViewFunction",value:function(e){return e.view?"function"==typeof e.view?e.view:function(t){return t+e.view}:function(e){return e}}},{key:"inject_inside",value:function(e){e.className="kio-base-info-panel",this.param_name_2_param={},this.param_name_2_value_element={};var t=document.createElement("table"),n=document.createElement("thead"),i=document.createElement("tbody");n.className="kio-base-info-panel-head",t.appendChild(n),t.appendChild(i);var o=document.createElement("tr"),a=document.createElement("td");a.colspan=2,n.appendChild(o),o.appendChild(a),a.innerText=this.title,this.value_elements=[];var r=!0,l=!1,s=void 0;try{for(var u,c=this.params[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var d=u.value;if(d.title){var m=document.createElement("tr"),p=document.createElement("td"),f=document.createElement("td");m.appendChild(p),m.appendChild(f),p.className="kio-base-info-panel-param-name",f.className="kio-base-info-panel-param-value",p.innerText=d.title,i.appendChild(m),this.value_elements.push(f)}}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}e.appendChild(t)}}]),e}(),s=function(){function e(t,n){i(this,e),this.domNode=document.createElement("button"),this.domNode.className="kio-base-control-button",this.title=t,$(this.domNode).click(n)}return r(e,[{key:"title",set:function(e){this._title=e,this.domNode.innerText=e},get:function(){return this._title}}]),e}()},,,,function(e,t){},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n,i){function o(e,n){var i=n.loading_queue;t.removeChild(c);var o=new s(u,t,i);o.init_view(t,u),o.saveEmptySolution(),o.loadSolution(o.best_from_server),o.loadSolution(o.autosavedSolution()),o.problem_is_initialized=!0}function a(){c.innerText="Ошибка при загрузке задачи, попробуйте обновить страницу"}function r(e){c.innerText="Загрузка "+e.progress+"%"}function l(){var e=document.createElement("div");return e.className="loading-info",e}var u=new e(n),c=l();if(t.appendChild(c),u.preloadManifest){var d=new createjs.LoadQueue(!0,i);d.on("complete",o,null,!1,{loading_queue:d}),d.on("error",a),d.on("progress",r);var m=u.preloadManifest();d.loadManifest(m)}else o(null,{loading_queue:null})}function a(e,t){if(t&&t.sol){var n=JSON.parse(t.sol),i=dces2contest.get_problem_index(e);u[i]=n}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.initializeKioProblem=o;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t,n,o){i(this,e),this.problem=t,this.domNode=n,this.pid=dces2contest.get_problem_index($(n)),this.best_from_server=u[dces2contest.get_problem_index($(n))],this.best=null,this.bestResult=null,this.autosave_localstorage_key="kio-problem-"+this.problem.id()+"-autosave",this.loading_queue=o,this.problem_is_initialized=!1}return l(e,[{key:"saveEmptySolution",value:function(){this.emptySolution=this.problem.solution()}},{key:"loadSolution",value:function(e){null!==e&&this.problem.loadSolution(e)}},{key:"bestSolution",value:function(){return this.best}},{key:"autosavedSolution",value:function(){return JSON.parse(localStorage.getItem(this.autosave_localstorage_key))}},{key:"autosaveSolution",value:function(){this.problem_is_initialized&&localStorage.setItem(this.autosave_localstorage_key,JSON.stringify(this.problem.solution()))}},{key:"newRecord",value:function(e,t){this.problem_is_initialized&&dces2contest.submit_answer(this.pid,{sol:JSON.stringify(e),res:JSON.stringify(t)})}},{key:"submitResult",value:function(e){this.results_info_panel.setParams(e),this.autosaveSolution();var t=this.compareResults(e,this.bestResult);t>0&&(this.bestResult=e,this.best=this.problem.solution(),this.newRecord(this.best,e),this.record_info_panel.setParams(e))}},{key:"compareResults",value:function(e,t){if(null==e&&null==t)return 0;if(null==e)return-1;if(null==t)return 1;var n=this.problem.parameters(),i=!0,o=!1,a=void 0;try{for(var r,l=n[Symbol.iterator]();!(i=(r=l.next()).done);i=!0){var s=r.value,u=e[s.name],c=t[s.name];s.normalize&&(u=s.normalize(u),c=s.normalize(c));var d="maximize"===s.ordering?u-c:c-u;if(Math.abs(d)>1e-9)return d>0?1:-1}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}return 0}},{key:"getResource",value:function(e){return this.loading_queue.getResult(e)}},{key:"init_view",value:function(e,t){var i=document.createElement("div"),o=document.createElement("div");i.className="kio-base-box",e.appendChild(i),e.appendChild(o);var a=n.i(r.a)(o,this);this.results_info_panel=a.results_info_panel,this.record_info_panel=a.record_info_panel;var l=$(e).width()-12;t.initialize(i,this,l)}}]),e}();dces2contest.register_solution_loader("kio-online",a);var u=[]}]);